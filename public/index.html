<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Daily Scanning Tracker - Track scanning operations across multiple locations">
  <title>ScanTrack Pro - Daily Scanning Tracker</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap"
    rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
  <link rel="stylesheet" href="/css/styles.css">
</head>

<body>

  <!-- LOGIN PAGE -->
  <div id="loginPage" class="login-page">
    <div class="login-bg-shapes">
      <div class="shape shape-1"></div>
      <div class="shape shape-2"></div>
      <div class="shape shape-3"></div>
    </div>
    <div class="login-card">
      <div class="login-logo">
        <div class="logo-icon"><i class="fas fa-qrcode"></i></div>
        <h1>ScanTrack <span>Pro</span></h1>
        <p>Daily Scanning Operations Tracker</p>
      </div>
      <form id="loginForm" class="login-form">
        <div class="form-group">
          <label for="loginUsername"><i class="fas fa-user"></i> Username</label>
          <input type="text" id="loginUsername" placeholder="Enter your username" required autocomplete="username">
        </div>
        <div class="form-group">
          <label for="loginPassword"><i class="fas fa-lock"></i> Password</label>
          <input type="password" id="loginPassword" placeholder="Enter your password" required
            autocomplete="current-password">
        </div>
        <button type="submit" id="loginBtn" class="btn btn-primary btn-full">
          <i class="fas fa-sign-in-alt"></i> Sign In
        </button>
        <div id="loginError" class="error-msg hidden"></div>
      </form>
    </div>
  </div>

  <!-- MAIN APP -->
  <div id="appContainer" class="app-container hidden">

    <!-- SIDEBAR OVERLAY (for mobile) -->
    <div id="sidebarOverlay" class="sidebar-overlay"></div>

    <!-- SIDEBAR -->
    <aside id="sidebar" class="sidebar">
      <div class="sidebar-header">
        <div class="sidebar-logo">
          <i class="fas fa-qrcode"></i>
          <span>ScanTrack</span>
        </div>
        <button id="sidebarToggle" class="sidebar-toggle"><i class="fas fa-bars"></i></button>
      </div>
      <nav class="sidebar-nav">
        <a href="#" class="nav-item active" data-page="dashboard" id="navDashboard">
          <i class="fas fa-chart-pie"></i><span>Dashboard</span>
        </a>
        <a href="#" class="nav-item manager-only" data-page="tracking" id="navTracking">
          <i class="fas fa-table"></i><span>Daily Tracking</span>
        </a>
        <a href="#" class="nav-item admin-only" data-page="locations" id="navLocations">
          <i class="fas fa-map-marker-alt"></i><span>Locations</span>
        </a>
        <a href="#" class="nav-item admin-only" data-page="expenses" id="navExpenses">
          <i class="fas fa-file-invoice-dollar"></i><span>Expenses</span>
        </a>
        <a href="#" class="nav-item manager-only" data-page="employees" id="navEmployees">
          <i class="fas fa-users"></i><span>Employees</span>
        </a>
        <a href="#" class="nav-item admin-only" data-page="roles" id="navRoles">
          <i class="fas fa-user-tag"></i><span>Roles</span>
        </a>
        <a href="#" class="nav-item admin-only" data-page="settings" id="navSettings">
          <i class="fas fa-cog"></i><span>Settings</span>
        </a>
      </nav>
      <div class="sidebar-footer">
        <div class="user-info">
          <div class="user-avatar" id="userAvatar">A</div>
          <div class="user-details">
            <span class="user-name" id="userName">Admin</span>
            <span class="user-role" id="userRole">Super Admin</span>
          </div>
        </div>
        <button id="logoutBtn" class="btn-logout"><i class="fas fa-sign-out-alt"></i></button>
      </div>
    </aside>

    <!-- MAIN CONTENT -->
    <main class="main-content">
      <header class="top-bar">
        <div class="top-bar-left">
          <button id="mobileSidebarToggle" class="mobile-sidebar-toggle"><i class="fas fa-bars"></i></button>
          <h2 id="pageTitle">Dashboard</h2>
        </div>
        <div class="top-bar-right">
          <div class="location-selector admin-only" id="globalLocationSelector">
            <i class="fas fa-map-marker-alt"></i>
            <select id="globalLocationFilter">
              <option value="">All Locations</option>
            </select>
          </div>
          <div class="location-badge manager-badge" id="locationBadge" style="display:none;">
            <i class="fas fa-map-marker-alt"></i>
            <span id="locationBadgeName"></span>
          </div>
          <div class="current-date">
            <i class="fas fa-calendar-alt"></i>
            <span id="currentDate"></span>
          </div>
        </div>
      </header>

      <!-- DASHBOARD PAGE -->
      <section id="pageDashboard" class="page active">

        <!-- OPERATOR/HANDLER VIEW - Simple personal dashboard -->
        <div id="operatorDashboard" class="operator-only" style="display: none;">
          <!-- Summary Cards - Row 1: Scans -->
          <div class="stats-grid" style="grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); margin-bottom: 16px;">
            <div class="stat-card stat-gradient-1">
              <div class="stat-icon"><i class="fas fa-file-alt"></i></div>
              <div class="stat-info">
                <span class="stat-value" id="myTotalScans">0</span>
                <span class="stat-label">Total Scans (All Time)</span>
              </div>
            </div>
            <div class="stat-card stat-gradient-2">
              <div class="stat-icon"><i class="fas fa-calendar-check"></i></div>
              <div class="stat-info">
                <span class="stat-value" id="myTodayScans">0</span>
                <span class="stat-label">Today's Scans</span>
              </div>
            </div>
            <div class="stat-card stat-gradient-3">
              <div class="stat-icon"><i class="fas fa-filter"></i></div>
              <div class="stat-info">
                <span class="stat-value" id="myFilteredScans">0</span>
                <span class="stat-label">Filtered Scans</span>
              </div>
            </div>
          </div>

          <!-- Summary Cards - Row 2: Earnings -->
          <div class="stats-grid" style="grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); margin-bottom: 24px;">
            <div class="stat-card" style="background: linear-gradient(135deg, #059669 0%, #10b981 100%);">
              <div class="stat-icon"><i class="fas fa-rupee-sign"></i></div>
              <div class="stat-info">
                <span class="stat-value" id="myTotalEarnings">₹0</span>
                <span class="stat-label">Total Earnings (All Time)</span>
              </div>
            </div>
            <div class="stat-card" style="background: linear-gradient(135deg, #0891b2 0%, #06b6d4 100%);">
              <div class="stat-icon"><i class="fas fa-money-bill-wave"></i></div>
              <div class="stat-info">
                <span class="stat-value" id="myTodayEarnings">₹0</span>
                <span class="stat-label">Today's Earnings</span>
              </div>
            </div>
            <div class="stat-card" style="background: linear-gradient(135deg, #7c3aed 0%, #8b5cf6 100%);">
              <div class="stat-icon"><i class="fas fa-wallet"></i></div>
              <div class="stat-info">
                <span class="stat-value" id="myFilteredEarnings">₹0</span>
                <span class="stat-label">Filtered Earnings</span>
              </div>
            </div>
          </div>

          <!-- Rate Info -->
          <div style="text-align: center; margin-bottom: 16px; padding: 12px; background: var(--bg-card); border-radius: var(--radius-md); border: 1px solid var(--border-color);">
            <span style="color: var(--text-muted);"><i class="fas fa-info-circle"></i> Your Rate: </span>
            <strong id="myRateDisplay" style="color: var(--primary);">₹0.00 per scan</strong>
          </div>

          <!-- Add Scan Button -->
          <div style="text-align: center; margin-bottom: 24px;">
            <button id="operatorAddScanBtn" class="btn btn-primary btn-lg">
              <i class="fas fa-plus"></i> Add Today's Scan Count
            </button>
          </div>

          <!-- Date Filter & History -->
          <div class="card">
            <div class="card-header" style="display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:12px;">
              <h3><i class="fas fa-history"></i> My Scan History</h3>
              <div class="date-range-filter">
                <label><i class="fas fa-calendar"></i> From:</label>
                <input type="date" id="operatorStartDate" class="form-input">
                <label><i class="fas fa-calendar"></i> To:</label>
                <input type="date" id="operatorEndDate" class="form-input">
              </div>
            </div>
            <div class="card-body" style="padding:0;">
              <table class="data-table">
                <thead>
                  <tr>
                    <th>Date</th>
                    <th>Status</th>
                    <th>Scans</th>
                    <th>Earnings</th>
                    <th>Notes</th>
                    <th style="width:60px;">Actions</th>
                  </tr>
                </thead>
                <tbody id="operatorHistoryBody">
                  <tr><td colspan="6" style="text-align:center;padding:20px;">Loading...</td></tr>
                </tbody>
                <tfoot>
                  <tr class="total-row">
                    <td colspan="2" style="text-align:right;"><strong>Total:</strong></td>
                    <td id="operatorHistoryTotal"><strong>0</strong></td>
                    <td id="operatorHistoryEarningsTotal" style="color:#22c55e;"><strong>₹0</strong></td>
                    <td colspan="2"></td>
                  </tr>
                </tfoot>
              </table>
            </div>
          </div>
        </div>

        <!-- ADMIN/MANAGER VIEW -->
        <div id="adminDashboard" class="manager-only">
          <!-- Filters -->
          <div class="page-actions" style="margin-bottom: 20px;">
            <div class="filter-group">
              <div class="date-range-filter">
                <label><i class="fas fa-calendar"></i> From:</label>
                <input type="date" id="dashboardStartDate" class="form-input">
                <label><i class="fas fa-calendar"></i> To:</label>
                <input type="date" id="dashboardEndDate" class="form-input">
              </div>
              <select id="dashboardLocationFilter" class="form-select admin-only" style="min-width: 180px;">
                <option value="">All Locations</option>
              </select>
            </div>
          </div>

          <!-- Simple Summary Cards -->
          <div id="summaryCardsGrid" class="stats-grid" style="margin-bottom: 24px;">
            <div class="stat-card stat-gradient-1">
              <div class="stat-icon"><i class="fas fa-file-alt"></i></div>
              <div class="stat-info">
                <span class="stat-value" id="totalScansAll">0</span>
                <span class="stat-label">Total Images</span>
              </div>
            </div>
            <div class="stat-card stat-gradient-2">
              <div class="stat-icon"><i class="fas fa-rupee-sign"></i></div>
              <div class="stat-info">
                <span class="stat-value" id="totalRevenueAll">₹0</span>
                <span class="stat-label">Our Earnings</span>
              </div>
            </div>
            <div class="stat-card stat-gradient-3">
              <div class="stat-icon"><i class="fas fa-users"></i></div>
              <div class="stat-info">
                <span class="stat-value" id="totalLabourAll">₹0</span>
                <span class="stat-label">Employee Cost</span>
              </div>
            </div>
            <div class="stat-card stat-gradient-4 admin-only">
              <div class="stat-icon"><i class="fas fa-receipt"></i></div>
              <div class="stat-info">
                <span class="stat-value" id="totalExpensesAll">₹0</span>
                <span class="stat-label">Expenses</span>
              </div>
            </div>
          </div>

          <!-- Location-wise Summary Table -->
          <div class="card">
            <div class="card-header">
              <h3><i class="fas fa-map-marker-alt"></i> Project / Location Summary</h3>
              <small style="color: var(--text-muted);">Click on a location to view details</small>
            </div>
            <div class="card-body" style="padding: 0;">
              <table class="data-table" style="margin: 0;" id="locationSummaryTable">
                <thead id="locationSummaryHead">
                  <tr>
                    <th>Location</th>
                    <th>Rate/Image</th>
                    <th>Total Images</th>
                    <th>Employee Cost</th>
                    <th class="admin-only">Expenses</th>
                    <th>Our Earnings</th>
                  </tr>
                </thead>
                <tbody id="locationSummaryBody">
                  <tr><td colspan="6" style="text-align:center;padding:40px;color:var(--text-muted);">Loading...</td></tr>
                </tbody>
                <tfoot id="locationSummaryFoot" style="background: var(--bg-secondary); font-weight: bold;"></tfoot>
              </table>
            </div>
          </div>

          <!-- Location Detail Panel (shown when location is clicked) -->
          <div id="locationDetailPanel" class="card" style="margin-top: 20px; display: none;">
            <div class="card-header" style="display: flex; justify-content: space-between; align-items: center;">
              <h3><i class="fas fa-building"></i> <span id="locationDetailName">Location Details</span></h3>
              <button id="closeLocationDetail" class="btn btn-icon"><i class="fas fa-times"></i></button>
            </div>
            <div class="card-body">
              <div class="stats-grid" style="grid-template-columns: repeat(4, 1fr); margin-bottom: 20px;">
                <div class="stat-card" style="background: var(--bg-secondary);">
                  <div class="stat-info" style="text-align: center;">
                    <span class="stat-value" id="locDetailScans">0</span>
                    <span class="stat-label">Total Images</span>
                  </div>
                </div>
                <div class="stat-card" style="background: var(--bg-secondary);">
                  <div class="stat-info" style="text-align: center;">
                    <span class="stat-value" id="locDetailRevenue">₹0</span>
                    <span class="stat-label">Our Earnings</span>
                  </div>
                </div>
                <div class="stat-card" style="background: var(--bg-secondary);">
                  <div class="stat-info" style="text-align: center;">
                    <span class="stat-value" id="locDetailCost">₹0</span>
                    <span class="stat-label">Employee Cost</span>
                  </div>
                </div>
                <div class="stat-card admin-only" style="background: var(--bg-secondary);">
                  <div class="stat-info" style="text-align: center;">
                    <span class="stat-value" id="locDetailExpenses">₹0</span>
                    <span class="stat-label">Expenses</span>
                  </div>
                </div>
              </div>
              <h4 style="margin-bottom: 10px; color: var(--text-muted);"><i class="fas fa-users"></i> Employees</h4>
              <div class="table-card">
                <table class="data-table">
                  <thead>
                    <tr>
                      <th>Name</th>
                      <th>Role</th>
                      <th>Total Images</th>
                      <th>Earnings</th>
                    </tr>
                  </thead>
                  <tbody id="locDetailEmployees"></tbody>
                </table>
              </div>
            </div>
          </div>
        </div>

      </section>

      <!-- DAILY TRACKING PAGE -->
      <section id="pageTracking" class="page">
        <div class="tracking-controls">
          <div class="month-picker">
            <button id="prevMonth" class="btn btn-icon"><i class="fas fa-chevron-left"></i></button>
            <span id="currentMonthLabel" class="month-label">February 2026</span>
            <button id="nextMonth" class="btn btn-icon"><i class="fas fa-chevron-right"></i></button>
          </div>
          <div class="tracking-actions">
            <button id="bulkEntryBtn" class="btn btn-primary manager-only"><i class="fas fa-edit"></i> Bulk Entry</button>
            <button id="addRecordBtn" class="btn btn-secondary manager-only"><i class="fas fa-plus"></i> Single Entry</button>
          </div>
        </div>

        <!-- BULK ENTRY PANEL -->
        <div id="bulkEntryPanel" class="bulk-entry-panel hidden">
          <div class="card">
            <div class="card-header bulk-entry-header">
              <h3><i class="fas fa-clipboard-list"></i> Bulk Data Entry</h3>
              <button id="bulkEntryClose" class="btn btn-icon" title="Close"><i class="fas fa-times"></i></button>
            </div>
            <div class="card-body">
              <!-- DATE NAVIGATOR -->
              <div class="bulk-date-navigator">
                <button id="bulkDatePrev" class="btn btn-icon" title="Previous Day"><i
                    class="fas fa-chevron-left"></i></button>
                <div class="bulk-date-display">
                  <input type="date" id="bulkDate" class="form-input-inline">
                  <span id="bulkDateLabel" class="bulk-date-label"></span>
                </div>
                <button id="bulkDateNext" class="btn btn-icon" title="Next Day"><i
                    class="fas fa-chevron-right"></i></button>
                <div class="bulk-date-shortcuts">
                  <button class="btn btn-sm btn-secondary" id="bulkDateToday">Today</button>
                  <button class="btn btn-sm btn-secondary" id="bulkDateYesterday">Yesterday</button>
                </div>
              </div>

              <div class="bulk-entry-table-wrapper">
                <table class="bulk-entry-table">
                  <thead>
                    <tr>
                      <th class="be-col-sno">#</th>
                      <th class="be-col-name">Employee Name</th>
                      <th class="be-col-count">Scan Count</th>
                      <th class="be-col-status">Status</th>
                      <th class="be-col-notes">Notes</th>
                    </tr>
                  </thead>
                  <tbody id="bulkEntryBody"></tbody>
                </table>
              </div>
              <div class="bulk-entry-footer">
                <div class="bulk-entry-summary">
                  <span><i class="fas fa-users"></i> Total: <strong id="bulkTotalEmployees">0</strong></span>
                  <span><i class="fas fa-user-check"></i> Present: <strong id="bulkPresentCount">0</strong></span>
                  <span><i class="fas fa-file-alt"></i> Total Scans: <strong id="bulkTotalScans">0</strong></span>
                </div>
                <button id="bulkSaveBtn" class="btn btn-primary btn-lg"><i class="fas fa-save"></i> Save All
                  Records</button>
              </div>
            </div>
          </div>
        </div>

        <!-- TRACKING TABLE -->
        <div id="trackingTableView" class="tracking-table-wrapper">
          <table id="trackingTable" class="tracking-table">
            <thead id="trackingHead"></thead>
            <tbody id="trackingBody"></tbody>
          </table>
        </div>
      </section>

      <!-- LOCATIONS PAGE -->
      <section id="pageLocations" class="page">
        <div class="page-actions">
          <button id="addLocationBtn" class="btn btn-primary"><i class="fas fa-plus"></i> Add Location</button>
        </div>
        <div class="cards-grid" id="locationsList"></div>
      </section>

      <!-- EMPLOYEES PAGE -->
      <section id="pageEmployees" class="page">
        <div class="page-actions">
          <div class="filter-group">
            <select id="employeeRoleFilter" class="form-select">
              <option value="">All Roles</option>
              <option value="location_manager">Location Manager</option>
              <option value="scanner_operator">Scanner Operator</option>
              <option value="file_handler">File Handler</option>
            </select>
            <select id="employeeLocationFilter" class="form-select admin-only">
              <option value="">All Locations</option>
            </select>
          </div>
          <button id="addEmployeeBtn" class="btn btn-primary"><i class="fas fa-plus"></i> Add Employee</button>
        </div>
        <div class="table-card">
          <table class="data-table">
            <thead>
              <tr>
                <th>Name</th>
                <th>Username</th>
                <th>Role</th>
                <th>Location</th>
                <th>Scanner</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody id="employeesList"></tbody>
          </table>
        </div>
      </section>

      <!-- EXPENSES PAGE (Super Admin Only) -->
      <section id="pageExpenses" class="page admin-only">
        <div class="page-actions">
          <div class="filter-group">
            <div class="date-range-filter">
              <label><i class="fas fa-calendar"></i> From:</label>
              <input type="date" id="expensesStartDate" class="form-input">
              <label><i class="fas fa-calendar"></i> To:</label>
              <input type="date" id="expensesEndDate" class="form-input">
            </div>
            <select id="expensesLocationFilter" class="form-select">
              <option value="">All Locations</option>
            </select>
          </div>
          <button id="addExpenseBtn" class="btn btn-primary"><i class="fas fa-plus"></i> Add Expense</button>
        </div>
        <div class="table-card">
          <table class="data-table">
            <thead>
              <tr>
                <th>Date</th>
                <th>Project / Location</th>
                <th>Description</th>
                <th>Paid By</th>
                <th>Amount (₹)</th>
                <th style="text-align:center;">Doc</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody id="expensesList"></tbody>
            <tfoot>
              <tr class="total-row">
                <td colspan="5" style="text-align:right;">Total Expenses:</td>
                <td id="expensesTotal">₹0</td>
                <td></td>
              </tr>
            </tfoot>
          </table>
        </div>
      </section>

      <!-- ROLES PAGE (Super Admin Only) -->
      <section id="pageRoles" class="page admin-only">
        <div class="page-actions">
          <h3><i class="fas fa-user-tag"></i> Manage Roles</h3>
          <button id="addRoleBtn" class="btn btn-primary"><i class="fas fa-plus"></i> Add Role</button>
        </div>
        <div class="table-card">
          <table class="data-table">
            <thead>
              <tr>
                <th>Role ID</th>
                <th>Display Name</th>
                <th>Description</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody id="rolesList"></tbody>
          </table>
        </div>
      </section>

      <!-- SETTINGS PAGE (Super Admin Only) -->
      <section id="pageSettings" class="page admin-only">
        <div class="page-header">
          <h3><i class="fas fa-cog"></i> Application Settings</h3>
        </div>
        <div class="card" style="max-width: 600px;">
          <div class="form-group">
            <label><i class="fas fa-money-bill-wave"></i> Per Page Scan Rate (₹)</label>
            <div style="display: flex; gap: 10px;">
              <input type="number" id="settingScanRate" step="0.01" min="0" class="form-input" style="flex:1;">
              <button id="saveSettingsBtn" class="btn btn-primary"><i class="fas fa-save"></i> Save</button>
            </div>
            <small class="text-muted">This rate is used to calculate daily earnings for all users.</small>
          </div>
        </div>
      </section>

    </main>
  </div>

  <!-- MODALS -->
  <div id="modal" class="modal-overlay hidden">
    <div class="modal-content">
      <div class="modal-header">
        <h3 id="modalTitle">Modal Title</h3>
        <button id="modalClose" class="modal-close"><i class="fas fa-times"></i></button>
      </div>
      <div class="modal-body" id="modalBody"></div>
    </div>
  </div>

  <!-- Toast -->
  <div id="toastContainer" class="toast-container"></div>

  <script src="/js/app.js"></script>
</body>

</html>